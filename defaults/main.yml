---

###
# Read REST authentication password from the passwordstore.
# If it does not exist yet, let the relevant task fail. This password should
# have been generated by the 'restic_client' role, which is a prerequisite for
# this role.
###
restic_remote_client_rest_password: "{{ restic_client_rest_password | default(lookup('passwordstore', 'IT/backup/auth/' + inventory_hostname)) }}"

###
# Username to use for initiating SSH connections as from server to client
###
restic_remote_server_user: "{{ restic_server_user | default('rest-server') }}"

###
# Groupname checked against asserting that a SSH private/public keypair exists
# on the server
###
restic_remote_server_group: "{{ restic_server_group | default('rest-server') }}"

###
# Port to use on client side to terminate SSH tunnel coming from the backup
# server. Set to a port not used by something else on the client. Defaults to
# the same port the 'restic_server' role uses to let the REST server listen on.
###
restic_remote_client_port: "{{ restic_server_listen_port | default('3000') }}"

###
# Username to use for SSH connections from server to client, and user which
# starts the `restic-backup.service` via sudo on the client.
###
restic_remote_client_user: "{{ restic_client_user | default('restic') }}"

###
# Groupname getting granted `sudo` privileges on client to start systemd
# services `restic-backup.service` and `restic-prune.service`. The client's
# user must be in this group.
###
restic_remote_client_group: "{{ restic_client_group | default('restic') }}"

###
# Construct config directory from 'restic_client' defaults. Required for
# placing the 'repository' file to the correct location.
###
restic_remote_client_home: "{{ restic_client_home | default('/home/' + restic_remote_client_user) }}"
restic_remote_client_config_dir: "{{ restic_client_config_dir | default(restic_remote_client_home + '/.config/restic') }}"

###
# Repeat from 'restic_client' role to check whether client should be configured
# to be backed up remotely by the backup server.
###
restic_remote_client_is_remote: "{{ restic_client_is_remote | default(false) }}"

###
# Do not show sensible content when printed by 'ansible-playbook' runs.
# Set to 'false' for debugging e.g. repository file templating.
###
restic_remote_no_log: true
